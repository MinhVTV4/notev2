/* --- Biến màu --- */
:root {
    /* Màu cơ bản & Giao diện */
    --bg-color: #f4f7f6;
    --text-color: #333;
    --card-bg-color: #ffffff;
    --border-color: #e0e0e0;
    --primary-color: #007bff; /* Màu nhấn - Sẽ được cập nhật bởi JS */
    --primary-text-color: #ffffff; /* Màu chữ trên nền màu nhấn */
    --secondary-color: #6c757d; /* Màu phụ (vd: timestamp, nút thường) */
    --danger-color: #dc3545; /* Màu cảnh báo/xóa */
    --success-color: #198754; /* Màu thành công/khôi phục */
    --input-bg-color: #ffffff;
    --input-border-color: #ced4da;
    --shadow-color: rgba(0, 0, 0, 0.08);
    --shadow-hover-color: rgba(0, 0, 0, 0.12);
    --fab-bg-color: var(--primary-color);
    --fab-text-color: var(--primary-text-color);
    --tag-bg-color: #e9ecef;
    --tag-text-color: #495057;
    --pin-color: var(--secondary-color);
    --pinned-color: #ffc107;
    --highlight-bg-color: #fff3cd;
    --highlight-text-color: #664d03;
    --archive-color: var(--secondary-color);
    --fade-color-start: rgba(255, 255, 255, 0);
    --fade-color-end: rgba(255, 255, 255, 1);
    --modal-backdrop-color: rgba(0, 0, 0, 0.6);
    --modal-content-bg: #ffffff;
    --modal-border-color: #ccc;

    /* Tab variables */
    --tab-bg: #f8f9fa; /* Nền nhẹ cho tab không active */
    --tab-text: var(--secondary-color);
    --tab-border-color: var(--border-color);
    --tab-hover-bg: #e9ecef; /* Nền rõ hơn khi hover */
    --tab-hover-text: var(--primary-color);
    --tab-active-bg: var(--card-bg-color); /* Nền giống card */
    --tab-active-border: var(--primary-color);
    --tab-active-text: var(--primary-color);
    --tab-radius: 6px 6px 0 0;

    /* Dog-ear variables */
    --dog-ear-size: 20px;
    --dog-ear-bg: var(--bg-color);
    --dog-ear-shadow: rgba(0, 0, 0, 0.1);

    /* Noise texture */
    --noise-opacity: 0.03;
    --noise-url: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noiseFilter)' opacity='1'/%3E%3C/svg%3E");

    /* Move Note Menu */
    --move-menu-bg: var(--card-bg-color);
    --move-menu-border: var(--border-color);
    --move-menu-shadow: var(--shadow-hover-color);
    --move-menu-item-hover-bg: var(--tab-hover-bg);


    /* Biến cho Font & Layout */
    --content-font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    --font-size-scale: 1;
    --note-gap: 20px;
    --sidebar-width: 240px; /* NEW: Sidebar width */
    --sidebar-collapsed-width: 70px; /* NEW: Collapsed sidebar width */

    /* Biến cho Cài đặt Giao diện */
    --setting-section-bg: rgba(0, 0, 0, 0.02);
    --setting-option-border: var(--border-color);
    --setting-option-hover-bg: rgba(0, 0, 0, 0.05);
    --setting-option-active-bg: var(--primary-color);
    --setting-option-active-text: var(--primary-text-color);
    --setting-option-active-border: var(--primary-color);

    /* Note Color Variables (Light Mode) */
    --note-color-yellow-bg: #fff9e0; --note-color-yellow-border: #ffecb3;
    --note-color-blue-bg: #e7f3ff; --note-color-blue-border: #bbdefb;
    --note-color-green-bg: #e8f5e9; --note-color-green-border: #c8e6c9;
    --note-color-red-bg: #ffebee; --note-color-red-border: #ffcdd2;
    --note-color-purple-bg: #f3e5f5; --note-color-purple-border: #e1bee7;
    --note-color-grey-bg: #f5f5f5; --note-color-grey-border: #e0e0e0;

    /* NEW: ToDo Variables */
    --todo-item-bg: var(--card-bg-color);
    --todo-item-border: var(--border-color);
    --todo-item-completed-bg: var(--setting-section-bg);
    --todo-item-completed-text: var(--secondary-color);
    --priority-high-color: #dc3545;
    --priority-medium-color: #ffc107;
    --priority-low-color: #6c757d;
    --due-soon-color: #fd7e14;
    --overdue-color: var(--danger-color);
}

/* ==================== DARK MODE ==================== */
body.dark-mode {
     --bg-color: #212529;
     --text-color: #dee2e6;
     --card-bg-color: #343a40;
     --border-color: #495057;
     --primary-text-color: #ffffff;
     --secondary-color: #adb5bd;
     --danger-color: #f84d5e;
     --success-color: #20c997;
     --input-bg-color: #495057;
     --input-border-color: #6c757d;
     --shadow-color: rgba(0, 0, 0, 0.25);
     --shadow-hover-color: rgba(0, 0, 0, 0.35);
     --tag-bg-color: #495057;
     --tag-text-color: #dee2e6;
     --pin-color: var(--secondary-color);
     --pinned-color: #FFD700;
     --highlight-bg-color: #a08a00;
     --highlight-text-color: #fff;
     --archive-color: var(--secondary-color);
     --fade-color-start: rgba(52, 58, 64, 0);
     --fade-color-end: rgba(52, 58, 64, 1);
     --modal-backdrop-color: rgba(0, 0, 0, 0.7);
     --modal-content-bg: #343a40;
     --modal-border-color: #495057;

     /* Tab variables for Dark Mode */
     --tab-bg: #2c3034; /* Nền tối nhẹ cho tab không active */
     --tab-text: var(--secondary-color);
     --tab-border-color: var(--border-color);
     --tab-hover-bg: #495057; /* Nền rõ hơn khi hover */
     --tab-hover-text: #e9ecef;
     --tab-active-bg: var(--card-bg-color);
     --tab-active-border: var(--primary-color);
     --tab-active-text: var(--primary-color);

     /* Dog-ear variables for Dark Mode */
     --dog-ear-bg: var(--bg-color);
     --dog-ear-shadow: rgba(0, 0, 0, 0.3);

     /* Noise texture for Dark Mode */
     --noise-opacity: 0.04;

     /* Move Note Menu Dark */
     --move-menu-bg: var(--modal-content-bg);
     --move-menu-border: var(--modal-border-color);
     --move-menu-shadow: var(--shadow-hover-color);
     --move-menu-item-hover-bg: var(--tab-hover-bg);

     /* Biến Cài đặt Dark Mode */
     --setting-section-bg: rgba(255, 255, 255, 0.04);
     --setting-option-border: var(--border-color);
     --setting-option-hover-bg: rgba(255, 255, 255, 0.1);

     /* Note Color Variables (Dark Mode) */
     --note-color-yellow-bg: #4d4222; --note-color-yellow-border: #806b38;
     --note-color-blue-bg: #2c3e50; --note-color-blue-border: #5dade2;
     --note-color-green-bg: #2e4b30; --note-color-green-border: #58d68d;
     --note-color-red-bg: #5c2b2e; --note-color-red-border: #ec7063;
     --note-color-purple-bg: #4a235a; --note-color-purple-border: #bb8fce;
     --note-color-grey-bg: #424242; --note-color-grey-border: #757575;

     /* NEW: ToDo Variables Dark */
    --todo-item-bg: var(--card-bg-color);
    --todo-item-border: var(--border-color);
    --todo-item-completed-bg: var(--setting-section-bg);
    --todo-item-completed-text: var(--secondary-color);
    --priority-high-color: #f84d5e;
    --priority-medium-color: #FFD700;
    --priority-low-color: #adb5bd;
    --due-soon-color: #ffc107;
    --overdue-color: var(--danger-color);
}

/* ==================== CÁC THEME KHÁC (GIỮ NGUYÊN) ==================== */
/* --- Sepia --- */
body.theme-sepia {
    --bg-color: #f4ecd8; --text-color: #5b4636; --card-bg-color: #fbf5e9; --border-color: #dcd0ba; --primary-text-color: #ffffff; --secondary-color: #a1887f; --danger-color: #c62828; --success-color: #558b2f; --input-bg-color: #fbf5e9; --input-border-color: #dcd0ba; --shadow-color: rgba(91, 70, 54, 0.1); --shadow-hover-color: rgba(91, 70, 54, 0.15); --tag-bg-color: #e5dace; --tag-text-color: #795548; --pin-color: var(--secondary-color); --pinned-color: #bcaaa4; --highlight-bg-color: #efebe9; --highlight-text-color: #3e2723; --fade-color-start: rgba(251, 245, 233, 0); --fade-color-end: rgba(251, 245, 233, 1); --modal-backdrop-color: rgba(91, 70, 54, 0.6); --modal-content-bg: #fbf5e9; --modal-border-color: #dcd0ba;
    --tab-bg: #fdfaf3; --tab-text: var(--secondary-color); --tab-border-color: var(--border-color); --tab-hover-bg: #efebe9; --tab-hover-text: var(--primary-color); --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color);
    --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(91, 70, 54, 0.1); --noise-opacity: 0.05;
    --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
    --setting-section-bg: rgba(91, 70, 54, 0.05); --setting-option-hover-bg: rgba(91, 70, 54, 0.1);
    --note-color-yellow-bg: #f9f3d6; --note-color-yellow-border: #d7ccc8; --note-color-blue-bg: #e8eaf6; --note-color-blue-border: #b0bec5; --note-color-green-bg: #e8f5e9; --note-color-green-border: #a5d6a7; --note-color-red-bg: #ffebee; --note-color-red-border: #ef9a9a; --note-color-purple-bg: #f3e5f5; --note-color-purple-border: #ce93d8; --note-color-grey-bg: #f5f5f5; --note-color-grey-border: #dcd0ba;
    /* NEW: ToDo Variables Sepia */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #c62828; --priority-medium-color: #bcaaa4; --priority-low-color: #a1887f; --due-soon-color: #bcaaa4; --overdue-color: var(--danger-color);
}
/* --- Solarized Light --- */
body.theme-solarized-light {
    --bg-color: #fdf6e3; --text-color: #657b83; --card-bg-color: #eee8d5; --border-color: #93a1a1; --primary-text-color: #fdf6e3; --secondary-color: #839496; --danger-color: #dc322f; --success-color: #859900; --input-bg-color: #eee8d5; --input-border-color: #93a1a1; --shadow-color: rgba(88, 110, 117, 0.1); --shadow-hover-color: rgba(88, 110, 117, 0.15); --tag-bg-color: #eee8d5; --tag-text-color: #586e75; --pin-color: var(--secondary-color); --pinned-color: #b58900; --highlight-bg-color: #eee8d5; --highlight-text-color: #cb4b16; --fade-color-start: rgba(238, 232, 213, 0); --fade-color-end: rgba(238, 232, 213, 1); --modal-backdrop-color: rgba(238, 232, 213, 0.6); --modal-content-bg: #fdf6e3; --modal-border-color: #eee8d5;
    --tab-bg: #f5efdc; --tab-text: var(--secondary-color); --tab-border-color: var(--border-color); --tab-hover-bg: #eee8d5; --tab-hover-text: #586e75; --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color);
    --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(88, 110, 117, 0.1); --noise-opacity: 0.03;
    --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
    --setting-section-bg: rgba(0, 43, 54, 0.03); --setting-option-hover-bg: rgba(0, 43, 54, 0.07);
    --note-color-yellow-bg: #fcf4b3; --note-color-yellow-border: #b58900; --note-color-blue-bg: #dfefff; --note-color-blue-border: #268bd2; --note-color-green-bg: #edf8d7; --note-color-green-border: #859900; --note-color-red-bg: #ffe4e1; --note-color-red-border: #dc322f; --note-color-purple-bg: #efebff; --note-color-purple-border: #6c71c4; --note-color-grey-bg: #eee8d5; --note-color-grey-border: #93a1a1;
    /* NEW: ToDo Variables Solarized Light */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #dc322f; --priority-medium-color: #b58900; --priority-low-color: #839496; --due-soon-color: #cb4b16; --overdue-color: var(--danger-color);
}
/* --- Solarized Dark --- */
body.theme-solarized-dark {
     --bg-color: #002b36; --text-color: #839496; --card-bg-color: #073642; --border-color: #586e75; --primary-text-color: #fdf6e3; --secondary-color: #586e75; --danger-color: #dc322f; --success-color: #859900; --input-bg-color: #073642; --input-border-color: #586e75; --shadow-color: rgba(0, 0, 0, 0.25); --shadow-hover-color: rgba(0, 0, 0, 0.35); --tag-bg-color: #586e75; --tag-text-color: #eee8d5; --pin-color: var(--secondary-color); --pinned-color: #b58900; --highlight-bg-color: #586e75; --highlight-text-color: #fdf6e3; --archive-color: var(--secondary-color); --fade-color-start: rgba(7, 54, 66, 0); --fade-color-end: rgba(7, 54, 66, 1); --modal-backdrop-color: rgba(0, 0, 0, 0.7); --modal-content-bg: #073642; --modal-border-color: #586e75;
     --tab-bg: #00252e; --tab-text: var(--secondary-color); --tab-border-color: var(--border-color); --tab-hover-bg: #073642; --tab-hover-text: #93a1a1; --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color);
     --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(0, 0, 0, 0.3); --noise-opacity: 0.04;
     --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
     --setting-section-bg: rgba(253, 246, 227, 0.05); --setting-option-hover-bg: rgba(253, 246, 227, 0.1);
     --note-color-yellow-bg: #3a300a; --note-color-yellow-border: #b58900; --note-color-blue-bg: #0d3f54; --note-color-blue-border: #268bd2; --note-color-green-bg: #2a3d00; --note-color-green-border: #859900; --note-color-red-bg: #4d1c1a; --note-color-red-border: #dc322f; --note-color-purple-bg: #2d2f51; --note-color-purple-border: #6c71c4; --note-color-grey-bg: #073642; --note-color-grey-border: #586e75;
    /* NEW: ToDo Variables Solarized Dark */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #dc322f; --priority-medium-color: #b58900; --priority-low-color: #586e75; --due-soon-color: #cb4b16; --overdue-color: var(--danger-color);
}
/* --- Nord --- */
body.theme-nord {
    --bg-color: #2E3440; --text-color: #D8DEE9; --card-bg-color: #3B4252; --border-color: #4C566A; --primary-color: #88C0D0; --primary-text-color: #2E3440; --secondary-color: #E5E9F0; --danger-color: #BF616A; --success-color: #A3BE8C; --input-bg-color: #434C5E; --input-border-color: #4C566A; --shadow-color: rgba(0, 0, 0, 0.2); --shadow-hover-color: rgba(0, 0, 0, 0.3); --tag-bg-color: #4C566A; --tag-text-color: #ECEFF4; --pin-color: var(--secondary-color); --pinned-color: #EBCB8B; --highlight-bg-color: #4C566A; --highlight-text-color: #EBCB8B; --fade-color-start: rgba(59, 66, 82, 0); --fade-color-end: rgba(59, 66, 82, 1); --modal-backdrop-color: rgba(46, 52, 64, 0.7); --modal-content-bg: #3B4252; --modal-border-color: #4C566A;
    --tab-bg: #353c4a; --tab-text: #D8DEE9; --tab-border-color: var(--border-color); --tab-hover-bg: #434c5e; --tab-hover-text: #ECEFF4; --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color); --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(0, 0, 0, 0.3); --noise-opacity: 0.03; --setting-section-bg: rgba(216, 222, 233, 0.04); --setting-option-hover-bg: rgba(216, 222, 233, 0.1);
    --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
    --note-color-yellow-bg: #4a453a; --note-color-yellow-border: #EBCB8B; --note-color-blue-bg: #3a485e; --note-color-blue-border: #81A1C1; --note-color-green-bg: #404c41; --note-color-green-border: #A3BE8C; --note-color-red-bg: #513a3f; --note-color-red-border: #BF616A; --note-color-purple-bg: #4a425e; --note-color-purple-border: #B48EAD; --note-color-grey-bg: #434C5E; --note-color-grey-border: #4C566A;
    /* NEW: ToDo Variables Nord */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #BF616A; --priority-medium-color: #EBCB8B; --priority-low-color: #D8DEE9; --due-soon-color: #D08770; --overdue-color: var(--danger-color);
}
/* --- Gruvbox Dark --- */
body.theme-gruvbox-dark {
    --bg-color: #282828; --text-color: #ebdbb2; --card-bg-color: #3c3836; --border-color: #504945; --primary-color: #fabd2f; --primary-text-color: #282828; --secondary-color: #a89984; --danger-color: #fb4934; --success-color: #b8bb26; --input-bg-color: #504945; --input-border-color: #665c54; --shadow-color: rgba(0, 0, 0, 0.25); --shadow-hover-color: rgba(0, 0, 0, 0.35); --tag-bg-color: #504945; --tag-text-color: #ebdbb2; --pin-color: var(--secondary-color); --pinned-color: #fabd2f; --highlight-bg-color: #504945; --highlight-text-color: #fabd2f; --fade-color-start: rgba(60, 56, 54, 0); --fade-color-end: rgba(60, 56, 54, 1); --modal-backdrop-color: rgba(40, 40, 40, 0.7); --modal-content-bg: #3c3836; --modal-border-color: #504945;
    --tab-bg: #32302f; --tab-text: #a89984; --tab-border-color: var(--border-color); --tab-hover-bg: #504945; --tab-hover-text: #ebdbb2; --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color); --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(0, 0, 0, 0.3); --noise-opacity: 0.05; --setting-section-bg: rgba(235, 219, 178, 0.04); --setting-option-hover-bg: rgba(235, 219, 178, 0.1);
    --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
    --note-color-yellow-bg: #4a453a; --note-color-yellow-border: #fabd2f; --note-color-blue-bg: #374a5a; --note-color-blue-border: #83a598; --note-color-green-bg: #464a3a; --note-color-green-border: #b8bb26; --note-color-red-bg: #513a3f; --note-color-red-border: #fb4934; --note-color-purple-bg: #4a425e; --note-color-purple-border: #d3869b; --note-color-grey-bg: #504945; --note-color-grey-border: #665c54;
    /* NEW: ToDo Variables Gruvbox Dark */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #fb4934; --priority-medium-color: #fabd2f; --priority-low-color: #a89984; --due-soon-color: #fe8019; --overdue-color: var(--danger-color);
}
/* --- Gruvbox Light --- */
body.theme-gruvbox-light {
    --bg-color: #fbf1c7; --text-color: #3c3836; --card-bg-color: #ebdbb2; --border-color: #d5c4a1; --primary-color: #d65d0e; --primary-text-color: #fbf1c7; --secondary-color: #7c6f64; --danger-color: #cc241d; --success-color: #98971a; --input-bg-color: #f9f5d7; --input-border-color: #d5c4a1; --shadow-color: rgba(60, 56, 54, 0.1); --shadow-hover-color: rgba(60, 56, 54, 0.15); --tag-bg-color: #d5c4a1; --tag-text-color: #3c3836; --pin-color: var(--secondary-color); --pinned-color: #d79921; --highlight-bg-color: #d5c4a1; --highlight-text-color: #af3a03; --fade-color-start: rgba(235, 219, 178, 0); --fade-color-end: rgba(235, 219, 178, 1); --modal-backdrop-color: rgba(251, 241, 199, 0.6); --modal-content-bg: #f9f5d7; --modal-border-color: #d5c4a1;
    --tab-bg: #f2e5bc; --tab-text: #7c6f64; --tab-border-color: var(--border-color); --tab-hover-bg: #d5c4a1; --tab-hover-text: #282828; --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color); --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(60, 56, 54, 0.1); --noise-opacity: 0.04; --setting-section-bg: rgba(60, 56, 54, 0.03); --setting-option-hover-bg: rgba(60, 56, 54, 0.07);
    --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
    --note-color-yellow-bg: #f2e5bc; --note-color-yellow-border: #d79921; --note-color-blue-bg: #d3e8e5; --note-color-blue-border: #458588; --note-color-green-bg: #e4e5bf; --note-color-green-border: #98971a; --note-color-red-bg: #f4cfcd; --note-color-red-border: #cc241d; --note-color-purple-bg: #e9d1d9; --note-color-purple-border: #b16286; --note-color-grey-bg: #d5c4a1; --note-color-grey-border: #bdae93;
    /* NEW: ToDo Variables Gruvbox Light */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #cc241d; --priority-medium-color: #d79921; --priority-low-color: #7c6f64; --due-soon-color: #d65d0e; --overdue-color: var(--danger-color);
}
/* --- Dracula --- */
body.theme-dracula {
    --bg-color: #282a36; --text-color: #f8f8f2; --card-bg-color: #44475a; --border-color: #6272a4; --primary-color: #bd93f9; --primary-text-color: #f8f8f2; --secondary-color: #f8f8f2; --danger-color: #ff5555; --success-color: #50fa7b; --input-bg-color: #282a36; --input-border-color: #6272a4; --shadow-color: rgba(0, 0, 0, 0.25); --shadow-hover-color: rgba(0, 0, 0, 0.35); --tag-bg-color: #6272a4; --tag-text-color: #f8f8f2; --pin-color: #6272a4; --pinned-color: #f1fa8c; --highlight-bg-color: #44475a; --highlight-text-color: #f1fa8c; --fade-color-start: rgba(68, 71, 90, 0); --fade-color-end: rgba(68, 71, 90, 1); --modal-backdrop-color: rgba(40, 42, 54, 0.7); --modal-content-bg: #44475a; --modal-border-color: #6272a4;
    --tab-bg: #3a3c4e; --tab-text: #bd93f9; --tab-border-color: var(--border-color); --tab-hover-bg: #6272a4; --tab-hover-text: #ff79c6; --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color); --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(0, 0, 0, 0.3); --noise-opacity: 0.03; --setting-section-bg: rgba(248, 248, 242, 0.04); --setting-option-hover-bg: rgba(248, 248, 242, 0.1);
    --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
    --note-color-yellow-bg: #4a483a; --note-color-yellow-border: #f1fa8c; --note-color-blue-bg: #3a5068; --note-color-blue-border: #8be9fd; --note-color-green-bg: #304d3a; --note-color-green-border: #50fa7b; --note-color-red-bg: #5c3030; --note-color-red-border: #ff5555; --note-color-purple-bg: #4a425e; --note-color-purple-border: #bd93f9; --note-color-grey-bg: #6272a4; --note-color-grey-border: #44475a;
    /* NEW: ToDo Variables Dracula */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #ff5555; --priority-medium-color: #f1fa8c; --priority-low-color: #6272a4; --due-soon-color: #ffb86c; --overdue-color: var(--danger-color);
}
/* --- Monochrome --- */
body.theme-monochrome {
    --bg-color: #f5f5f5; --text-color: #212121; --card-bg-color: #ffffff; --border-color: #e0e0e0; --primary-color: #616161; --primary-text-color: #ffffff; --secondary-color: #757575; --danger-color: #757575; --success-color: #616161; --input-bg-color: #ffffff; --input-border-color: #bdbdbd; --shadow-color: rgba(0, 0, 0, 0.08); --shadow-hover-color: rgba(0, 0, 0, 0.12); --tag-bg-color: #eeeeee; --tag-text-color: #616161; --pin-color: var(--secondary-color); --pinned-color: #424242; --highlight-bg-color: #e0e0e0; --highlight-text-color: #212121; --fade-color-start: rgba(255, 255, 255, 0); --fade-color-end: rgba(255, 255, 255, 1); --modal-backdrop-color: rgba(0, 0, 0, 0.6); --modal-content-bg: #ffffff; --modal-border-color: #e0e0e0;
    --tab-bg: #eeeeee; --tab-text: var(--secondary-color); --tab-border-color: var(--border-color); --tab-hover-bg: #e0e0e0; --tab-hover-text: var(--primary-color); --tab-active-bg: var(--card-bg-color); --tab-active-border: var(--primary-color); --tab-active-text: var(--primary-color); --dog-ear-bg: var(--bg-color); --dog-ear-shadow: rgba(0, 0, 0, 0.1); --noise-opacity: 0.02; --setting-section-bg: rgba(0, 0, 0, 0.02); --setting-option-hover-bg: rgba(0, 0, 0, 0.05);
    --move-menu-bg: var(--modal-content-bg); --move-menu-border: var(--modal-border-color); --move-menu-shadow: var(--shadow-hover-color); --move-menu-item-hover-bg: var(--tab-hover-bg);
    --note-color-yellow-bg: #fafafa; --note-color-yellow-border: #bdbdbd; --note-color-blue-bg: #f5f5f5; --note-color-blue-border: #9e9e9e; --note-color-green-bg: #eeeeee; --note-color-green-border: #757575; --note-color-red-bg: #f5f5f5; --note-color-red-border: #616161; --note-color-purple-bg: #fafafa; --note-color-purple-border: #9e9e9e; --note-color-grey-bg: #eeeeee; --note-color-grey-border: #bdbdbd;
    /* NEW: ToDo Variables Monochrome */
    --todo-item-bg: var(--card-bg-color); --todo-item-border: var(--border-color); --todo-item-completed-bg: var(--setting-section-bg); --todo-item-completed-text: var(--secondary-color); --priority-high-color: #424242; --priority-medium-color: #757575; --priority-low-color: #bdbdbd; --due-soon-color: #757575; --overdue-color: #424242;
}
/* ================================================= */


/* --- CSS Cơ bản --- */
html {
    box-sizing: border-box;
}
*, *:before, *:after {
    box-sizing: inherit;
}

body {
    font-family: var(--content-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif);
    margin: 0;
    /* padding: 20px; REMOVED - Padding will be handled by main-content */
    background-color: var(--bg-color);
    color: var(--text-color);
    font-size: calc(1rem * var(--font-size-scale, 1));
    line-height: 1.6;
    transition: background-color 0.3s, color 0.3s, font-size 0.1s linear;
    overflow-x: hidden; /* Prevent horizontal scroll on body */
}

/* ==================== NEW LAYOUT STYLES ==================== */
.app-layout {
    display: flex;
    min-height: 100vh; /* Ensure layout takes full viewport height */
}

/* --- Sidebar Styles --- */
.app-sidebar {
    width: var(--sidebar-width);
    background-color: var(--card-bg-color);
    border-right: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    position: fixed; /* Fixed sidebar */
    left: 0;
    top: 0;
    height: 100%;
    z-index: 1500; /* Above main content, below modals */
    transition: width 0.3s ease, background-color 0.3s, border-color 0.3s;
    box-shadow: 2px 0 5px rgba(0,0,0,0.05);
}
body.dark-mode .app-sidebar {
    box-shadow: 2px 0 5px rgba(0,0,0,0.15);
}

.sidebar-header {
    padding: 15px 20px;
    border-bottom: 1px solid var(--border-color);
    flex-shrink: 0;
}
.sidebar-header h2 {
    margin: 0;
    font-size: 1.5em;
    color: var(--primary-color);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.sidebar-nav {
    flex-grow: 1;
    overflow-y: auto; /* Allow scrolling if menu is long */
    padding: 15px 0;
}
.sidebar-nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
}
.sidebar-nav li a {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    color: var(--text-color);
    text-decoration: none;
    transition: background-color 0.2s, color 0.2s;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.sidebar-nav li a:hover {
    background-color: var(--setting-option-hover-bg);
    color: var(--primary-color);
}
.sidebar-nav li a.active {
    background-color: rgba(var(--rgb-primary-color, 0, 123, 255), 0.1); /* Use primary color with alpha */
    color: var(--primary-color);
    font-weight: 600;
    border-left: 3px solid var(--primary-color);
    padding-left: 17px; /* Adjust padding to account for border */
}
.sidebar-nav li a i { /* Placeholder for icons */
    margin-right: 12px;
    font-style: normal; /* Remove italic if using text */
    min-width: 20px; /* Ensure space for icon */
    text-align: center;
    font-size: 1.1em;
    opacity: 0.8;
}
.sidebar-nav li a.active i {
    opacity: 1;
}

.nav-divider {
    height: 1px;
    background-color: var(--border-color);
    margin: 10px 20px;
}

.sidebar-footer {
    padding: 15px 20px;
    border-top: 1px solid var(--border-color);
    flex-shrink: 0;
    text-align: center;
}
.sidebar-footer small {
    font-size: 0.8em;
    color: var(--secondary-color);
    opacity: 0.7;
}

/* --- Main Content Styles --- */
.main-content {
    flex-grow: 1;
    padding: 20px 25px; /* Add padding inside main content */
    margin-left: var(--sidebar-width); /* Offset by sidebar width */
    transition: margin-left 0.3s ease;
    overflow-y: auto; /* Allow content scrolling independently */
    /* background-color: var(--bg-color); /* Ensure main content has bg */
}

/* --- Main Header Styles (Adjusted) --- */
.main-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap; /* Allow wrapping on smaller screens */
    gap: 15px;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--border-color);
}

/* Search input takes more space */
#search-input {
    flex-grow: 1; /* Allow search to take available space */
    min-width: 200px; /* Minimum width before wrapping */
    /* Keep existing styles */
    display: block;
    width: auto; /* Override previous width calc */
    padding: 10px 12px;
    border: 1px solid var(--input-border-color);
    border-radius: 5px;
    background-color: var(--input-bg-color);
    color: var(--text-color);
    font-size: 1em;
}
#search-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 2px rgba(var(--rgb-primary-color, 0, 123, 255), 0.25);
}

/* Header actions group */
.header-actions {
    display: flex;
    flex-wrap: wrap; /* Allow buttons to wrap */
    gap: 8px;
    align-items: center;
    flex-shrink: 0; /* Prevent shrinking */
}
.header-actions button {
    padding: 8px 12px;
    background-color: var(--secondary-color);
    color: var(--primary-text-color);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.2s, opacity 0.2s;
    font-size: 0.9em;
    white-space: nowrap;
    line-height: 1.4;
}
.header-actions button:hover { opacity: 0.85; }

/* Specific button colors (keep as is) */
#export-notes-btn { background-color: var(--success-color); }
#import-notes-btn { background-color: var(--primary-color); }
#manage-notebooks-btn { background-color: #6f42c1; }
body.dark-mode #manage-notebooks-btn { background-color: #8a63d2; }
#manage-templates-btn { background-color: #17a2b8; }
body.dark-mode #manage-templates-btn { background-color: #34a4b7; }
#empty-trash-btn { background-color: var(--danger-color); }
#empty-trash-btn.hidden { display: none !important; }
#view-archive-btn { background-color: var(--secondary-color); }
#view-archive-btn.viewing-archive { background-color: var(--primary-color); font-weight: bold; }
#view-trash-btn { background-color: var(--secondary-color); }
#view-trash-btn.viewing-trash { background-color: var(--danger-color); font-weight: bold; }

/* Status indicators (keep as is, but they are now inside main-header) */
.archive-status, .trash-status {
    width: 100%; /* Span full width if header wraps */
    order: 3; /* Ensure they appear below search/actions if wrapped */
    text-align: center;
    padding: 8px;
    margin-top: 5px;
    font-size: 0.9em;
    font-style: italic;
    color: var(--secondary-color);
    border-radius: 4px;
    background-color: var(--setting-section-bg);
}
.archive-status.hidden, .trash-status.hidden { display: none; }

/* --- Module Switching Styles --- */
.module {
    display: none; /* Hide modules by default */
}
.module.active-module {
    display: block; /* Show the active module */
    animation: fadeIn 0.3s ease-in-out; /* Optional fade-in effect */
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Hide module-specific header buttons when module is inactive */
.header-actions button[data-module-target]:not([data-module-target="all"]) {
    display: none; /* Hide by default */
}
/* Show buttons for the active module */
/* Example for Notes module: */
body[data-active-module="notes"] .header-actions button[data-module-target="notes"] {
    display: inline-block;
}
body[data-active-module="notes"] #archive-status-indicator[data-module-target="notes"],
body[data-active-module="notes"] #trash-status-indicator[data-module-target="notes"] {
    /* Keep display controlled by JS 'hidden' class */
}
/* Example for ToDo module (if it had specific buttons): */
/* body[data-active-module="todo"] .header-actions button[data-module-target="todo"] {
    display: inline-block;
} */


/* --- Notebook Tabs Styles (Inside #notes-module) --- */
/* Keep existing styles, ensure they work within the new structure */
.notebook-tabs {
    display: flex;
    flex-wrap: nowrap;
    gap: 4px;
    padding: 0;
    margin-bottom: 25px;
    border-bottom: 1px solid var(--tab-border-color);
    overflow-x: auto;
    scrollbar-width: thin;
    scrollbar-color: var(--secondary-color) var(--bg-color);
    position: relative;
}
.notebook-tabs::-webkit-scrollbar { height: 6px; }
.notebook-tabs::-webkit-scrollbar-track { background: var(--bg-color); border-radius: 3px; }
.notebook-tabs::-webkit-scrollbar-thumb { background-color: var(--secondary-color); border-radius: 3px; }
.notebook-tabs::-webkit-scrollbar-thumb:hover { background-color: var(--primary-color); }

.tab-button {
    padding: 10px 18px;
    border: 1px solid var(--tab-border-color);
    border-bottom: none;
    background-color: var(--tab-bg);
    color: var(--tab-text);
    cursor: pointer;
    font-size: 0.95em;
    font-weight: 500;
    white-space: nowrap;
    transition: color 0.2s, border-color 0.2s, background-color 0.2s, box-shadow 0.2s;
    border-radius: var(--tab-radius);
    margin-bottom: -1px;
    flex-shrink: 0;
    position: relative;
    box-shadow: inset 0 -2px 5px -2px rgba(0,0,0,0.05);
}
.tab-button:hover {
    color: var(--tab-hover-text);
    background-color: var(--tab-hover-bg);
    border-color: var(--border-color);
    z-index: 1;
}
.tab-button.active {
    color: var(--tab-active-text);
    background-color: var(--tab-active-bg);
    border-color: var(--tab-border-color);
    border-bottom-color: var(--tab-active-bg);
    font-weight: 600;
    z-index: 2;
    box-shadow: 0 -2px 4px rgba(0,0,0,0.05);
}
.tab-button.active::after {
    content: '';
    position: absolute;
    bottom: 0px;
    left: 0;
    right: 0;
    height: 3px;
    background-color: var(--tab-active-border);
    border-radius: 2px 2px 0 0;
}
.add-tab-button {
    padding: 8px 12px;
    margin-left: 8px;
    margin-bottom: 2px;
    border: 1px dashed var(--secondary-color);
    border-radius: 50%;
    background-color: transparent;
    color: var(--secondary-color);
    font-size: 1.1em;
    font-weight: bold;
    cursor: pointer;
    transition: color 0.2s, border-color 0.2s, background-color 0.2s, transform 0.1s;
    line-height: 1;
    flex-shrink: 0;
    align-self: center;
}
.add-tab-button:hover {
    color: var(--primary-color);
    border-color: var(--primary-color);
    border-style: solid;
    background-color: var(--tab-hover-bg);
    transform: scale(1.1);
}


/* --- Panel Thêm Note (Inside #notes-module) --- */
/* Keep existing styles */
#add-note-panel { padding: 20px; margin-bottom: 20px; background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 8px; box-shadow: 0 3px 8px var(--shadow-color); position: relative; }
.hidden { display: none !important; }
#add-note-panel .form-group { margin-bottom: 15px; }
#add-note-panel label { display: block; margin-bottom: 5px; font-weight: 500; font-size: 0.9em; color: var(--secondary-color); }
#add-note-panel select, #add-note-panel textarea, #add-note-panel input[type="text"] { display: block; width: 100%; /* Adjusted width */ padding: 10px; border: 1px solid var(--input-border-color); border-radius: 5px; background-color: var(--input-bg-color); color: var(--text-color); font-size: 1em; font-family: inherit; }
#add-note-panel select { cursor: pointer; }
#add-note-panel textarea { min-height: 80px; resize: vertical; line-height: 1.5; }
#add-note-panel input:focus, #add-note-panel textarea:focus, #add-note-panel select:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(var(--rgb-primary-color, 0, 123, 255), 0.25); }
#add-note-panel .panel-actions { display: flex; justify-content: flex-end; align-items: center; margin-top: 15px; gap: 10px; }
#add-note-panel #add-note-btn { padding: 10px 20px; background-color: var(--primary-color); color: var(--primary-text-color); border: none; border-radius: 5px; cursor: pointer; font-size: 1em; transition: background-color 0.2s, opacity 0.2s; }
#add-note-panel #add-note-btn:hover { opacity: 0.85; }
#add-note-panel #close-add-panel-btn { padding: 8px 15px; background-color: var(--secondary-color); color: var(--primary-text-color); border: none; border-radius: 5px; cursor: pointer; font-size: 0.9em; transition: background-color 0.2s, opacity 0.2s; }
#add-note-panel #close-add-panel-btn:hover { opacity: 0.85; }


/* --- Notes Container & Note Card (Inside #notes-module) --- */
/* Keep existing styles */
#notes-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: var(--note-gap, 20px);
}
.note {
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 15px 18px;
    box-shadow: 0 1px 3px var(--shadow-color);
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.25s ease-in-out, transform 0.25s ease-in-out, background-color 0.3s, border-color 0.3s, border-left-color 0.3s;
    cursor: grab;
    user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;
    position: relative;
    overflow: hidden;
    min-height: 150px;
    border-left: 5px solid transparent;
    background-color: var(--card-bg-color);
}
.note::after { /* Noise */
    content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-image: var(--noise-url); opacity: var(--noise-opacity); pointer-events: none; z-index: 0; transition: opacity 0.3s;
}
.note:active { cursor: grabbing; }
.note:hover { box-shadow: 0 5px 15px var(--shadow-hover-color); transform: translateY(-3px); }
.note::before { /* Dog-ear */
    content: ""; position: absolute; top: 0; right: 0; border-width: 0 var(--dog-ear-size) var(--dog-ear-size) 0; border-style: solid;
    border-color: transparent transparent var(--dog-ear-bg) var(--dog-ear-bg); box-shadow: -1px 1px 2px var(--dog-ear-shadow); z-index: 1; transition: border-color 0.3s;
}
/* Dog-ear colors */
.note.note-color-yellow::before { border-color: transparent transparent var(--note-color-yellow-bg) var(--note-color-yellow-bg); }
.note.note-color-blue::before { border-color: transparent transparent var(--note-color-blue-bg) var(--note-color-blue-bg); }
.note.note-color-green::before { border-color: transparent transparent var(--note-color-green-bg) var(--note-color-green-bg); }
.note.note-color-red::before { border-color: transparent transparent var(--note-color-red-bg) var(--note-color-red-bg); }
.note.note-color-purple::before { border-color: transparent transparent var(--note-color-purple-bg) var(--note-color-purple-bg); }
.note.note-color-grey::before { border-color: transparent transparent var(--note-color-grey-bg) var(--note-color-grey-bg); }

.pinned-bookmark-icon { position: absolute; top: -10px; right: -10px; font-size: 2.8em; color: var(--pinned-color); opacity: 0.5; pointer-events: none; transform: rotate(45deg); z-index: 2; transition: color 0.3s, opacity 0.3s; }
/* Note color classes */
.note.note-color-yellow { background-color: var(--note-color-yellow-bg); border-left-color: var(--note-color-yellow-border); }
.note.note-color-blue { background-color: var(--note-color-blue-bg); border-left-color: var(--note-color-blue-border); }
.note.note-color-green { background-color: var(--note-color-green-bg); border-left-color: var(--note-color-green-border); }
.note.note-color-red { background-color: var(--note-color-red-bg); border-left-color: var(--note-color-red-border); }
.note.note-color-purple { background-color: var(--note-color-purple-bg); border-left-color: var(--note-color-purple-border); }
.note.note-color-grey { background-color: var(--note-color-grey-bg); border-left-color: var(--note-color-grey-border); }
.note[class*="note-color-"] { border-top-color: transparent; border-right-color: transparent; border-bottom-color: transparent; }

.note-title { font-size: 1.15em; font-weight: 600; margin: 0 0 10px 0; word-wrap: break-word; color: var(--primary-color); position: relative; z-index: 1; padding-bottom: 8px; border-bottom: 1px solid var(--border-color); margin-bottom: 12px; }
.note-content { flex-grow: 1; word-wrap: break-word; white-space: pre-wrap; font-size: 1em; position: relative; z-index: 1; max-height: 200px; overflow: hidden; font-family: var(--content-font-family, inherit); line-height: 1.5; color: var(--text-color); }
.note-content.has-overflow { position: relative; }
.note-content.has-overflow::after { /* Fade out */
    content: ""; position: absolute; bottom: 0; left: 0; width: 100%; height: 40px;
    background: linear-gradient(to top, var(--fade-color-end), var(--fade-color-start)); pointer-events: none; z-index: 2;
}
.read-more-btn { display: block; margin: 5px auto 0 auto; padding: 3px 10px; font-size: 0.8em; color: var(--primary-color); background-color: transparent; border: none; border-radius: 4px; cursor: pointer; text-align: center; z-index: 3; position: relative; text-decoration: underline; opacity: 0.8; }
.read-more-btn:hover { opacity: 1; }

.note-timestamp { font-size: 0.8em; color: var(--secondary-color); margin-bottom: 10px; display: block; position: relative; z-index: 1; opacity: 0.8; }
.note-tags { margin-bottom: 10px; display: flex; flex-wrap: wrap; gap: 5px; position: relative; z-index: 1; }
.tag-badge { background-color: var(--tag-bg-color); color: var(--tag-text-color); padding: 3px 8px; border-radius: 10px; font-size: 0.8em; transition: background-color 0.2s, color 0.2s, opacity 0.2s; border: none; cursor: pointer; line-height: 1.4; opacity: 0.9; }
.tag-badge:hover { opacity: 1; background-color: var(--primary-color); color: var(--primary-text-color); }
.note-actions { display: flex; justify-content: flex-end; align-items: center; gap: 5px; border-top: 1px solid var(--border-color); padding-top: 10px; margin-top: auto; position: relative; z-index: 1; }
.note-actions button { padding: 5px; border: none; border-radius: 50%; width: 30px; height: 30px; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; font-size: 1.1em; transition: opacity 0.2s, color 0.2s, background-color 0.2s; background-color: transparent; color: var(--secondary-color); line-height: 1; }
.note-actions button:hover { opacity: 1; background-color: rgba(128, 128, 128, 0.15); }
.note-actions .edit-btn { color: var(--primary-color); }
.note-actions .delete-btn, .note-actions .delete-permanent-btn { color: var(--danger-color); }
.note-actions .pin-btn { color: var(--pin-color); }
.note-actions .pin-btn.pinned { color: var(--pinned-color); }
.note-actions .unarchive-btn, .note-actions .restore-btn { color: var(--success-color); }
.note-actions .delete-permanent-btn { font-weight: bold; font-size: 0.8em; }
.note-actions .edit-btn { font-size: 0.9em; }
.note-actions .delete-btn { font-size: 0.9em; }

/* Note Edit Mode */
.note input[type="text"].edit-title-input,
.note textarea.edit-input,
.note input[type="text"].edit-tags-input {
    display: block; width: 100%; /* Adjusted */ margin-bottom: 10px; border: 1px solid var(--input-border-color); border-radius: 5px;
    background-color: var(--input-bg-color); color: var(--text-color); font-size: 1em; padding: 5px; cursor: text; position: relative; z-index: 2; font-family: inherit;
}
.note input[type="text"].edit-title-input { font-weight: 600; border-bottom: 1px solid var(--input-border-color); padding-bottom: 5px; margin-bottom: 10px; }
.note textarea.edit-input { min-height: 80px; resize: vertical; line-height: 1.5; white-space: pre-wrap; margin-top: 0; }
.note input:focus, .note textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(var(--rgb-primary-color, 0, 123, 255), 0.25); }

/* Color Selector */
.color-selector-container { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; margin-bottom: 12px; padding: 5px 0; position: relative; z-index: 2; }
.color-swatch-btn { width: 24px; height: 24px; border-radius: 50%; border: 2px solid transparent; cursor: pointer; padding: 0; font-size: 0; transition: transform 0.1s ease-out, border-color 0.2s, box-shadow 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; }
.color-swatch-btn:hover { transform: scale(1.1); }
.color-swatch-btn.selected { border-color: var(--primary-color); transform: scale(1.15); box-shadow: 0 0 0 2px var(--bg-color), 0 0 0 4px var(--primary-color); }
.color-swatch-btn.default-color-swatch { background-color: var(--card-bg-color); border: 1px dashed var(--secondary-color); color: var(--secondary-color); font-size: 14px; line-height: 20px; text-align: center; box-shadow: none; }
.color-swatch-btn.default-color-swatch:hover { border-style: solid; border-color: var(--secondary-color); }
.color-swatch-btn.default-color-swatch.selected { border: 2px solid var(--primary-color) !important; box-shadow: 0 0 0 2px var(--bg-color), 0 0 0 4px var(--primary-color); background-color: var(--card-bg-color); color: var(--primary-color); }

/* --- Other Styles (Keep as is) --- */
.empty-state { grid-column: 1 / -1; text-align: center; color: var(--secondary-color); padding: 30px; font-style: italic; }
#template-list-container .empty-state,
#notebook-list-container .empty-state { padding: 15px; grid-column: auto; }

/* SortableJS Styles */
.note.sortable-ghost { opacity: 0.4; background-color: var(--primary-color) !important; border: 1px dashed var(--primary-text-color); transform: translateY(0); }
.note.sortable-chosen { opacity: 0.9; box-shadow: 0 5px 15px var(--shadow-color); transform: scale(1.02) translateY(-3px); cursor: grabbing; }
.note.sortable-drag { opacity: 0.9; cursor: grabbing; transform: scale(1.02) translateY(-3px); }

/* Floating Action Button (FAB) */
/* Now positioned relative to main-content if needed, or keep fixed */
.fab { position: fixed; bottom: 30px; right: 30px; width: 55px; height: 55px; background-color: var(--fab-bg-color); color: var(--fab-text-color); border: none; border-radius: 50%; font-size: 28px; line-height: 55px; text-align: center; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); cursor: pointer; z-index: 1000; transition: transform 0.2s ease-in-out, background-color 0.3s, visibility 0s linear 0.1s, opacity 0.1s linear; }
.fab:hover { transform: scale(1.1); }
.fab.hidden { visibility: hidden; opacity: 0; transform: scale(0.5); transition-delay: 0s; }
/* Hide FAB if notes module is not active */
body:not([data-active-module="notes"]) #show-add-panel-btn {
    display: none;
}


/* Tag Suggestions */
.tag-suggestions { position: absolute; background-color: var(--card-bg-color); border: 1px solid var(--border-color); border-radius: 4px; box-shadow: 0 4px 8px var(--shadow-color); max-height: 150px; overflow-y: auto; z-index: 1001; width: auto; min-width: 150px; margin-top: 2px; }
.suggestion-item { padding: 8px 12px; cursor: pointer; font-size: 0.9em; color: var(--text-color); border-bottom: 1px solid var(--border-color); white-space: nowrap; outline: none; }
.suggestion-item:last-child { border-bottom: none; }
.suggestion-item:hover, .suggestion-item:focus { background-color: var(--setting-option-hover-bg); color: var(--primary-color); }

/* Highlighted Text (Search) */
mark { background-color: var(--highlight-bg-color); color: var(--highlight-text-color); padding: 0.1em 0.2em; border-radius: 3px; box-shadow: 0 0 0 1px var(--highlight-bg-color); }

/* Modal Styles (Generic - Keep as is) */
.modal { position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: hidden; background-color: var(--modal-backdrop-color); display: flex; align-items: center; justify-content: center; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0s linear 0.3s; }
.modal.visible { opacity: 1; visibility: visible; transition: opacity 0.3s ease, visibility 0s linear 0s; overflow-y: auto; }
.modal:not(.hidden) { display: flex; }
.modal-content { background-color: var(--modal-content-bg); color: var(--text-color); margin: 5vh auto; padding: 20px 25px; border: 1px solid var(--modal-border-color); border-radius: 8px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 5px 15px rgba(0,0,0,0.2); position: relative; display: flex; flex-direction: column; transition: transform 0.3s ease; transform: scale(0.95); }
.modal.visible .modal-content { transform: scale(1); }
.note-modal .modal-content { max-width: 700px; }
.template-modal-content { max-width: 600px; }
.notebook-modal-content { max-width: 550px; }
.settings-modal-content { max-width: 650px; }
.modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; margin-bottom: 20px; flex-shrink: 0; }
.modal-header h2 { margin: 0; font-size: 1.4em; color: var(--primary-color); }
.modal-body { line-height: 1.6; flex-grow: 1; padding-top: 5px; }
.note-modal .modal-body { white-space: pre-wrap; }
.close-modal-btn { background: none; border: none; color: var(--secondary-color); font-size: 28px; font-weight: bold; cursor: pointer; padding: 0 5px; line-height: 1; }
.close-modal-btn:hover, .close-modal-btn:focus { color: var(--text-color); opacity: 0.8; outline: none; }

/* Auto-save / Manual Save Visual Feedback */
@keyframes flash-border { 0% { box-shadow: 0 0 0 0 rgba(var(--rgb-success-color, 25, 135, 84), 0.5); } 70% { box-shadow: 0 0 0 5px rgba(var(--rgb-success-color, 25, 135, 84), 0); } 100% { box-shadow: 0 0 0 0 rgba(var(--rgb-success-color, 25, 135, 84), 0); } }
.note.note-autosaved, .note.note-saved-flash {
    box-shadow: 0 0 0 2px var(--success-color);
    transition: box-shadow 0.2s ease-out;
}
body.dark-mode .note.note-autosaved, body.dark-mode .note.note-saved-flash {
    box-shadow: 0 0 0 2px var(--success-color);
}

/* Template Management Modal Styles (Keep as is) */
#template-list-section { margin-bottom: 20px; }
#template-list-section h3, #template-edit-panel h3 { margin-top: 0; margin-bottom: 15px; font-size: 1.2em; color: var(--primary-color); }
#template-list-container { margin-top: 15px; margin-bottom: 15px; max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 5px; padding: 5px; }
.template-list-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 10px; border-bottom: 1px solid var(--border-color); }
.template-list-item:last-child { border-bottom: none; }
.template-list-item span { font-weight: 500; margin-right: 10px; word-break: break-word; }
.template-item-actions { display: flex; gap: 8px; flex-shrink: 0; }
#template-edit-panel { padding: 15px; border: 1px solid var(--border-color); border-radius: 5px; background-color: var(--setting-section-bg); }
#template-edit-panel .form-group { margin-bottom: 12px; }
#template-edit-panel label { display: block; margin-bottom: 4px; font-weight: 500; font-size: 0.9em; color: var(--secondary-color); }
#template-edit-panel input[type="text"], #template-edit-panel textarea { width: 100%; padding: 8px 10px; border: 1px solid var(--input-border-color); border-radius: 4px; background-color: var(--input-bg-color); color: var(--text-color); font-size: 1em; font-family: inherit; }
#template-edit-panel input:focus, #template-edit-panel textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(var(--rgb-primary-color, 0, 123, 255), 0.25); }
#template-edit-panel textarea { min-height: 70px; resize: vertical; line-height: 1.5; }
#template-edit-panel .panel-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }

/* Notebook Modal Styles (Keep as is) */
#notebook-list-section { margin-bottom: 20px; }
#notebook-list-section h3, #notebook-edit-panel h3 { margin-top: 0; margin-bottom: 15px; font-size: 1.2em; color: var(--primary-color); }
#notebook-list-container { margin-top: 15px; margin-bottom: 15px; max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 5px; padding: 5px; }
.notebook-list-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 10px; border-bottom: 1px solid var(--border-color); }
.notebook-list-item:last-child { border-bottom: none; }
.notebook-list-item span { font-weight: 500; margin-right: 10px; word-break: break-word; }
.notebook-item-actions { display: flex; gap: 8px; flex-shrink: 0; }
#notebook-edit-panel { padding: 15px; border: 1px solid var(--border-color); border-radius: 5px; background-color: var(--setting-section-bg); }
#notebook-edit-panel .form-group { margin-bottom: 12px; }
#notebook-edit-panel label { display: block; margin-bottom: 4px; font-weight: 500; font-size: 0.9em; color: var(--secondary-color); }
#notebook-edit-panel input[type="text"] { width: 100%; padding: 8px 10px; border: 1px solid var(--input-border-color); border-radius: 4px; background-color: var(--input-bg-color); color: var(--text-color); font-size: 1em; font-family: inherit; }
#notebook-edit-panel input:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 2px rgba(var(--rgb-primary-color, 0, 123, 255), 0.25); }
#notebook-edit-panel .panel-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; }

/* Move Note Menu Styles (Keep as is) */
.move-note-menu { position: absolute; background-color: var(--move-menu-bg); border: 1px solid var(--move-menu-border); border-radius: 4px; box-shadow: 0 2px 8px var(--move-menu-shadow); min-width: 150px; max-height: 200px; overflow-y: auto; z-index: 10; padding: 5px 0; }
.move-note-menu button { display: block; width: 100%; padding: 8px 15px; background: none; border: none; color: var(--text-color); text-align: left; cursor: pointer; font-size: 0.9em; white-space: nowrap; }
.move-note-menu button:hover { background-color: var(--move-menu-item-hover-bg); color: var(--primary-color); }
.move-note-menu button.current-notebook { font-weight: bold; color: var(--primary-color); cursor: default; background-color: transparent !important; }
.move-note-menu hr { border: none; border-top: 1px solid var(--move-menu-border); margin: 5px 0; }

/* Generic Modal Button Styles (Keep as is) */
.modal-button { padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.95em; transition: background-color 0.2s, opacity 0.2s, border-color 0.2s, color 0.2s; border: 1px solid transparent; background-color: transparent; line-height: 1.4; }
.modal-button.primary { background-color: var(--primary-color); color: var(--primary-text-color); border-color: var(--primary-color); }
.modal-button.primary:hover { opacity: 0.85; }
.modal-button.secondary { background-color: var(--secondary-color); color: var(--primary-text-color); border-color: var(--secondary-color); }
.modal-button.secondary:hover { opacity: 0.85; }
.modal-button.danger { background-color: transparent; color: var(--danger-color); border-color: var(--danger-color); }
.modal-button.danger:hover { background-color: var(--danger-color); color: var(--primary-text-color); opacity: 0.9; }
.modal-button.small-button { padding: 5px 10px !important; font-size: 0.85em !important; }
#show-add-template-panel-btn,
#show-add-notebook-panel-btn { background-color: var(--success-color); color: var(--primary-text-color); border: none; margin-top: 10px; }
#show-add-template-panel-btn:hover,
#show-add-notebook-panel-btn:hover { opacity: 0.9; }

/* Settings Modal Styles (Keep as is) */
.setting-section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color); }
.setting-section:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
.setting-section h3 { margin-top: 0; margin-bottom: 15px; font-size: 1.2em; color: var(--primary-color); }
.setting-options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: 10px; }
.setting-option-button { padding: 10px 15px; border: 1px solid var(--setting-option-border); border-radius: 5px; background-color: var(--card-bg-color); color: var(--text-color); cursor: pointer; text-align: center; font-size: 0.95em; transition: background-color 0.2s, border-color 0.2s, color 0.2s; }
.setting-option-button:hover { background-color: var(--setting-option-hover-bg); }
.setting-option-button.active { background-color: var(--setting-option-active-bg); color: var(--setting-option-active-text); border-color: var(--setting-option-active-border); font-weight: bold; }
.accent-color-options { display: flex; flex-wrap: wrap; gap: 10px; }
#font-family-select { width: 100%; padding: 8px 10px; border: 1px solid var(--input-border-color); border-radius: 5px; background-color: var(--input-bg-color); color: var(--text-color); font-size: 0.95em; cursor: pointer; }
body.dark-mode #font-family-select option { background-color: var(--card-bg-color); color: var(--text-color); }
.font-size-control { display: flex; align-items: center; gap: 15px; }
#font-size-slider { flex-grow: 1; cursor: pointer; accent-color: var(--primary-color); }
#font-size-value { min-width: 45px; text-align: right; font-weight: 500; color: var(--secondary-color); }
#reset-font-size-btn {}

/* Tiện ích ẩn accessibly */
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border-width: 0; }


/* ==================== NEW TODO MODULE STYLES ==================== */
#todo-module .module-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border-color);
}
#todo-module .module-header h2 {
    margin: 0;
    font-size: 1.5em;
    color: var(--primary-color);
    display: flex;
    align-items: center;
    gap: 8px;
}
#todo-module .module-header h2 i { /* Placeholder icon */
    font-style: normal;
    opacity: 0.8;
}
.todo-options label {
    margin-right: 5px;
    font-size: 0.9em;
    color: var(--secondary-color);
}
.todo-options select {
    padding: 5px 8px;
    border-radius: 4px;
    border: 1px solid var(--input-border-color);
    background-color: var(--input-bg-color);
    color: var(--text-color);
    font-size: 0.9em;
}

#add-todo-panel {
    display: flex;
    flex-wrap: wrap; /* Allow wrapping */
    gap: 10px;
    margin-bottom: 25px;
    padding: 15px;
    background-color: var(--card-bg-color);
    border: 1px solid var(--border-color);
    border-radius: 8px;
}
#add-todo-panel input[type="text"] {
    flex-grow: 1; /* Take available space */
    min-width: 200px; /* Min width before wrap */
    padding: 10px;
    border: 1px solid var(--input-border-color);
    border-radius: 5px;
    background-color: var(--input-bg-color);
    color: var(--text-color);
    font-size: 1em;
}
#add-todo-panel select,
#add-todo-panel input[type="date"] {
    padding: 10px;
    border: 1px solid var(--input-border-color);
    border-radius: 5px;
    background-color: var(--input-bg-color);
    color: var(--text-color);
    font-size: 1em;
    cursor: pointer;
    flex-shrink: 0; /* Prevent shrinking */
}
#add-todo-panel button {
    padding: 10px 15px;
    background-color: var(--primary-color);
    color: var(--primary-text-color);
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.2s, opacity 0.2s;
    flex-shrink: 0;
}
#add-todo-panel button:hover {
    opacity: 0.85;
}

#todo-list-container {
    display: flex;
    flex-direction: column;
    gap: 10px; /* Space between todo items */
}

/* Placeholder for todo item styling */
.todo-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 15px;
    background-color: var(--todo-item-bg);
    border: 1px solid var(--todo-item-border);
    border-radius: 5px;
    transition: background-color 0.3s, border-color 0.3s, opacity 0.3s;
}
.todo-item input[type="checkbox"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: var(--primary-color); /* Color the checkbox */
    flex-shrink: 0;
}
.todo-item .todo-content {
    flex-grow: 1;
    word-break: break-word;
    line-height: 1.4;
}
.todo-item .todo-priority {
    font-size: 0.8em;
    padding: 2px 6px;
    border-radius: 4px;
    color: var(--primary-text-color);
    font-weight: 500;
    flex-shrink: 0;
}
.todo-item .todo-priority[data-priority="high"] { background-color: var(--priority-high-color); }
.todo-item .todo-priority[data-priority="medium"] { background-color: var(--priority-medium-color); color: #333; /* Adjust text color for yellow */ }
body.dark-mode .todo-item .todo-priority[data-priority="medium"] { color: #333; } /* Keep dark text on yellow in dark mode */
.todo-item .todo-priority[data-priority="low"] { background-color: var(--priority-low-color); }

.todo-item .todo-due-date {
    font-size: 0.85em;
    color: var(--secondary-color);
    flex-shrink: 0;
    white-space: nowrap;
}
.todo-item .todo-due-date.due-soon {
    color: var(--due-soon-color);
    font-weight: bold;
}
.todo-item .todo-due-date.overdue {
    color: var(--overdue-color);
    font-weight: bold;
}

.todo-item .todo-actions {
    display: flex;
    gap: 5px;
    flex-shrink: 0;
}
.todo-item .todo-actions button {
    padding: 4px;
    border: none;
    border-radius: 50%;
    width: 28px;
    height: 28px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 1em;
    transition: opacity 0.2s, color 0.2s, background-color 0.2s;
    background-color: transparent;
    color: var(--secondary-color);
    line-height: 1;
}
.todo-item .todo-actions button:hover {
    background-color: rgba(128, 128, 128, 0.15);
}
.todo-item .todo-actions .edit-todo-btn { color: var(--primary-color); }
.todo-item .todo-actions .delete-todo-btn { color: var(--danger-color); }

/* Completed ToDo Item */
.todo-item.completed {
    background-color: var(--todo-item-completed-bg);
    opacity: 0.7;
}
.todo-item.completed .todo-content {
    text-decoration: line-through;
    color: var(--todo-item-completed-text);
}


/* ===================================================================== */
/* ==================== RESPONSIVE STYLES (UPDATED) ==================== */
/* ===================================================================== */

/* Medium screens (Tablets) - Collapse sidebar to icons */
@media (max-width: 992px) {
    :root {
        --sidebar-width: var(--sidebar-collapsed-width);
    }
    .app-sidebar {
        overflow: hidden; /* Hide text overflow */
    }
    .sidebar-header h2,
    .sidebar-nav li a span, /* Hide text */
    .sidebar-footer small {
        display: none; /* Hide text elements */
    }
    .sidebar-nav li a {
        justify-content: center; /* Center icon */
        padding: 15px 0; /* Adjust padding */
    }
    .sidebar-nav li a i {
        margin-right: 0; /* Remove margin when text is hidden */
        font-size: 1.3em; /* Slightly larger icons */
    }
     .sidebar-nav li a.active {
        padding-left: 0; /* Reset padding */
        border-left-width: 0; /* Remove left border */
        /* Optional: Add different active indicator */
        background-color: rgba(var(--rgb-primary-color, 0, 123, 255), 0.15);
        position: relative;
    }
     .sidebar-nav li a.active::before { /* Add top border as indicator */
        content: '';
        position: absolute;
        top: 0;
        left: 10%;
        right: 10%;
        height: 3px;
        background-color: var(--primary-color);
        border-radius: 0 0 2px 2px;
    }

    .main-content {
        margin-left: var(--sidebar-collapsed-width);
        padding: 15px 20px; /* Slightly reduce padding */
    }
}


/* Small screens (Phones) - Consider Off-canvas sidebar later */
/* For now, keep collapsed sidebar */
@media (max-width: 768px) {
    body {
        font-size: calc(0.95rem * var(--font-size-scale, 1));
    }

    :root {
         --note-gap: 12px;
         /* Keep collapsed sidebar width */
         /* --sidebar-width: var(--sidebar-collapsed-width); */
    }

    .main-content {
        margin-left: var(--sidebar-collapsed-width);
        padding: 10px 15px; /* Further reduce padding */
    }

    /* Adjust Main Header for smaller screens */
    .main-header {
        gap: 10px;
        margin-bottom: 20px;
        padding-bottom: 10px;
    }
    #search-input {
        padding: 8px 10px;
        font-size: 0.95em;
        min-width: 150px; /* Adjust min-width */
    }
    .header-actions {
        gap: 6px;
    }
    .header-actions button {
        padding: 6px 10px;
        font-size: 0.85em;
    }
    .archive-status, .trash-status {
        margin-top: 8px;
        padding: 6px;
    }

    /* === Notebook Tabs for Mobile (Inside #notes-module) === */
    .notebook-tabs {
        flex-wrap: wrap;
        margin-bottom: 15px;
        padding-bottom: 5px;
    }
    .tab-button {
        margin-bottom: 4px;
        border: 1px solid var(--tab-border-color);
        border-radius: 4px;
        box-shadow: none;
    }
    .tab-button.active {
        border-bottom-color: var(--tab-border-color);
        box-shadow: inset 0 0 0 2px var(--tab-active-border);
    }
    .tab-button.active::after { display: none; }
    .add-tab-button { margin-left: 4px; margin-bottom: 4px; }

    /* FAB */
    .fab {
        bottom: 15px; right: 15px; width: 50px; height: 50px; font-size: 24px; line-height: 50px;
    }

    /* Note Actions */
    .note-actions button { width: 34px; height: 34px; font-size: 1.2em; }
    .note-actions .edit-btn, .note-actions .delete-btn { font-size: 0.85em; }
    .note-actions .delete-permanent-btn { font-size: 0.75em; }

    /* Modals */
    .modal-content { padding: 15px 20px; width: 90%; max-width: 90%; max-height: 85vh; margin: 7.5vh auto; }
    .modal-header h2 { font-size: 1.2em; }
    .close-modal-btn { font-size: 26px; }

    /* Add Note Panel */
    #add-note-panel { padding: 15px; }
    #add-note-panel textarea { min-height: 60px; }
    #add-note-panel .panel-actions { gap: 8px; }
    #add-note-panel #add-note-btn { padding: 8px 15px; font-size: 0.95em; }
    #add-note-panel #close-add-panel-btn { padding: 6px 12px; font-size: 0.85em; }

    /* Tag Suggestions */
    .tag-suggestions { max-height: 120px; }
    .suggestion-item { padding: 6px 10px; font-size: 0.85em; }

    /* ToDo Add Panel */
    #add-todo-panel {
        padding: 10px;
        gap: 8px;
    }
    #add-todo-panel input[type="text"],
    #add-todo-panel select,
    #add-todo-panel input[type="date"] {
        padding: 8px;
        font-size: 0.95em;
    }
     #add-todo-panel button {
        padding: 8px 12px;
        font-size: 0.95em;
    }
    /* ToDo Item */
    .todo-item {
        padding: 10px 12px;
        gap: 8px;
    }
    .todo-item .todo-priority { font-size: 0.75em; padding: 2px 5px; }
    .todo-item .todo-due-date { font-size: 0.8em; }
    .todo-item .todo-actions button { width: 26px; height: 26px; font-size: 0.9em;}

}

/* Very Small Screens */
@media (max-width: 480px) { /* Adjusted breakpoint */
    :root {
        --note-gap: 8px;
        /* Consider making sidebar absolute/off-canvas here */
        /* For now, keep collapsed */
         --sidebar-width: var(--sidebar-collapsed-width);
    }
    .main-content {
        margin-left: var(--sidebar-collapsed-width);
        padding: 8px 10px;
    }
    #notes-container {
        grid-template-columns: 1fr; /* Force single column */
    }

    .main-header {
        flex-direction: column; /* Stack search and actions */
        align-items: stretch; /* Stretch items full width */
    }
     #search-input {
         margin-bottom: 10px; /* Add space below search */
     }
    .header-actions {
        justify-content: center; /* Center buttons */
    }

    .note { padding: 12px 15px; }
    .note-title { font-size: 1.1em; }
    .note-content { font-size: 0.95em; max-height: 150px; }
    .note-timestamp, .tag-badge { font-size: 0.75em; }

    /* Modals */
    .modal-content { max-height: 90vh; margin: 5vh auto; padding: 10px 15px; }
    .modal-header h2 { font-size: 1.1em; }

    /* ToDo Item - Adjust further if needed */
    .todo-item {
        flex-wrap: wrap; /* Allow wrapping inside todo item */
    }
    .todo-item .todo-content {
        width: 100%; /* Make content take full width below checkbox */
        order: 1; /* Place content after checkbox */
        margin-left: 28px; /* Indent content (checkbox width + gap) */
        margin-top: -10px; /* Pull up slightly */
        margin-bottom: 5px;
    }
     .todo-item .todo-priority,
     .todo-item .todo-due-date,
     .todo-item .todo-actions {
        order: 2; /* Place these after content */
        margin-left: 28px; /* Indent */
    }
    .todo-item .todo-actions {
        margin-left: auto; /* Push actions to the right */
    }


}
